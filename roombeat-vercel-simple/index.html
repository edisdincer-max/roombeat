<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Roombeat — Kadıköy</title>
<link rel="icon" type="image/png" href="favicon.png">
<script src="https://w.soundcloud.com/player/api.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{--bg:#0B47FF;--ink:#111;--paper:#fff;--muted:#666;--accent:#FFD447}
*{box-sizing:border-box} html,body{margin:0;padding:0;background:var(--bg);color:var(--paper);
font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
.header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.brand{display:flex;align-items:center;gap:10px;font-weight:900;letter-spacing:.6px;text-transform:uppercase}
.badge{width:40px;height:40px;border-radius:10px;background:#0F0F0F;color:#FFD447;display:grid;place-items:center;border:2px solid #000}
.btn{background:var(--paper);color:#000;border:2px solid #000;border-radius:12px;padding:10px 14px;font-weight:900;cursor:pointer;text-decoration:none;display:inline-block}
.btn.primary{background:var(--accent)}
.pill{display:inline-flex;gap:8px;align-items:center;background:var(--paper);color:#000;border:2px solid #000;border-radius:999px;padding:6px 10px}
.hero h1{font-size:clamp(30px,6vw,58px);margin:.2em 0;text-transform:uppercase;line-height:1}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px} @media(max-width:900px){.grid{grid-template-columns:1fr 1fr}} @media(max-width:640px){.grid{grid-template-columns:1fr}}
.card{background:#fff;color:#000;border:2px solid #000;border-radius:14px;padding:16px;box-shadow:6px 6px 0 rgba(0,0,0,.15)}
footer{padding:18px;text-align:center;color:#ddd}
.route{display:none} .route.active{display:block}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:50}
.modal .box{background:#fff;color:#000;border:2px solid #000;border-radius:14px;max-width:560px;width:92vw;padding:16px}
input,textarea,select{width:100%;padding:10px;border:2px solid #000;border-radius:12px;font:inherit}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px} @media(max-width:680px){.row{grid-template-columns:1fr}}
#audioBtn{position:fixed;right:16px;bottom:16px;z-index:60}
</style>
</head>
<body>
<div class="wrap header">
  <div class="brand"><div class="badge">RB</div><div>ROOMBEAT</div></div>
  <div style="display:flex;gap:8px;flex-wrap:wrap">
    <a class="btn" href="#/">Home</a>
    <a class="btn" href="#/profiles">Profiles</a>
    <a class="btn" href="#/me">My Profile</a>
    <a class="btn" href="#/roadmap">Roadmap</a>
    <button id="authBtn" class="btn">Auth</button>
    <button id="settingsBtn" class="btn">Settings</button>
  </div>
</div>

<main class="wrap">
  <div id="route-home" class="route active">
    <section class="hero">
      <span class="pill">Kadıköy • Erasmus • Rooms</span>
      <h1>Your home in the heart of Kadıköy</h1>
      <p>Furnished rooms, ikamet-friendly contracts, secure deposits & a social vibe.</p>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
        <a class="btn primary" id="waCta" href="https://wa.me/34655274054" target="_blank">WhatsApp</a>
        <a class="btn" href="#/profiles">Meet people</a>
      </div>
    </section>
  </div>

  <div id="route-profiles" class="route">
    <div class="card"><b>Profiles</b><br>Login required to view the directory.</div>
  </div>

  <div id="route-me" class="route">
    <h2>My Profile</h2>
    <form id="meForm" class="card" onsubmit="return false;">
      <div class="row">
        <div><label>Name<input id="me_name"></label></div>
        <div><label>WhatsApp (private)<input id="me_whatsapp" placeholder="+90 ..."></label></div>
      </div>
      <div class="row">
        <div><label>Nationality<input id="me_nat"></label></div>
        <div><label>University<input id="me_uni"></label></div>
      </div>
      <div class="row">
        <div><label>Arrival<input id="me_arrival" placeholder="Feb"></label></div>
        <div><label>Budget (€)<input id="me_budget" type="number" min="0" step="10"></label></div>
      </div>
      <div><label>Bio<textarea id="me_bio" rows="4"></textarea></label></div>
      <div style="margin-top:10px"><button class="btn primary" id="meSave">Save</button></div>
    </form>
  </div>

  <div id="route-roadmap" class="route">
    <h2>Roadmap</h2>
    <div class="grid">
      <div class="card"><b>Phase 1</b><br>Listings, multilingual, profiles</div>
      <div class="card"><b>Phase 2</b><br>Escrow wallet, contracts, fees</div>
      <div class="card"><b>Phase 3</b><br>Events, games, points</div>
    </div>
  </div>
</main>

<!-- auth modal -->
<div id="authModal" class="modal">
  <div class="box">
    <h3>Sign In</h3>
    <p id="authMsg" style="color:#666">Apple / Google ya da e‑posta magic link ekleyebiliriz.
    Şimdilik test için sadece e‑posta linki mevcut.</p>
    <div class="row">
      <div><label>Email<input id="authEmail" placeholder="you@example.com"></label></div>
    </div>
    <div style="margin-top:10px;display:flex;gap:10px">
      <button id="sendMagic" class="btn primary">Send Magic Link</button>
      <button id="closeAuth" class="btn">Close</button>
    </div>
    <div id="authStatus" style="margin-top:8px;color:#333"></div>
  </div>
</div>

<!-- settings modal -->
<div id="settingsModal" class="modal">
  <div class="box">
    <h3>Supabase Settings</h3>
    <div class="row">
      <div><label>SUPABASE_URL<input id="sbUrl" placeholder="https://xxxx.supabase.co"></label></div>
      <div><label>SUPABASE_ANON<textarea id="sbAnon" rows="3" placeholder="eyJhbGciOi..."></textarea></label></div>
    </div>
    <div style="margin-top:10px;display:flex;gap:10px">
      <button id="saveSettings" class="btn primary">Save & Reload</button>
      <button id="closeSettings" class="btn">Close</button>
    </div>
  </div>
</div>

<iframe id="player" width="0" height="0" frameborder="no" allow="autoplay"
  src="https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fuser-202286394-991268468%2Fmishka-071125&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&visual=false"></iframe>
<button id="audioBtn" class="btn primary">Play set (37:02)</button>

<footer>© <span id="y"></span> Roombeat</footer>

<script>
const routes={"#/":"route-home","#":"route-home","": "route-home","#/profiles":"route-profiles","#/me":"route-me","#/roadmap":"route-roadmap"};
function nav(){const k=location.hash.split('?')[0];const id=routes[k]||"route-home";document.querySelectorAll('.route').forEach(e=>e.classList.remove('active'));document.getElementById(id).classList.add('active');}
window.addEventListener('hashchange', nav); nav(); document.getElementById('y').textContent=new Date().getFullYear();

// SoundCloud at 37:02
const widget = SC.Widget(document.getElementById('player')); let did=false;
widget.bind(SC.Widget.Events.READY, function(){ widget.setVolume(22); widget.bind(SC.Widget.Events.PLAY_PROGRESS, function(){ if(!did){ widget.seekTo(2222000); did=true; } }); });
document.getElementById('audioBtn').onclick=()=>{ widget.seekTo(2222000); widget.play(); };

// Settings modal
const AUTH_KEY='rb_sb'; const S=JSON.parse(localStorage.getItem(AUTH_KEY)||'{}');
const settingsModal=document.getElementById('settingsModal');
document.getElementById('settingsBtn').onclick=()=>settingsModal.style.display='flex';
document.getElementById('closeSettings').onclick=()=>settingsModal.style.display='none';
document.getElementById('saveSettings').onclick=()=>{ const u=document.getElementById('sbUrl').value.trim(); const a=document.getElementById('sbAnon').value.trim(); localStorage.setItem(AUTH_KEY, JSON.stringify({url:u,anon:a})); location.reload(); };
document.getElementById('sbUrl').value=S.url||''; document.getElementById('sbAnon').value=S.anon||'';

// Auth modal (magic link)
const authModal=document.getElementById('authModal'); const authEmail=document.getElementById('authEmail'); const authStatus=document.getElementById('authStatus');
document.getElementById('authBtn').onclick=()=>authModal.style.display='flex'; document.getElementById('closeAuth').onclick=()=>authModal.style.display='none';
let supa=null; if(window.supabase && S.url && S.anon){ supa = window.supabase.createClient(S.url,S.anon); }
document.getElementById('sendMagic').onclick=async()=>{ if(!supa) return alert('Önce Settings → Supabase anahtarlarını gir.'); const email=authEmail.value.trim(); if(!email) return alert('Email yaz.'); const {error}=await supa.auth.signInWithOtp({email, options:{emailRedirectTo: window.location.href}}); authStatus.textContent= error ? ('Error: '+error.message) : 'Magic link sent. Check inbox.'; };
</script>
</body>
</html>
